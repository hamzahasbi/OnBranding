branches:
  only:
    - develop
    - main
notifications:
  email: false


test: &test
  stage: Test
  dist: bionic
  os: linux
  language: node_js
  node_js:
    - node
  cache:
    - yarn
    - directories:
      - node_modules
  matrix:
    fast_finish: true  
  before_install:
    - curl -o- -L https://yarnpkg.com/install.sh | bash -s -- --version 1.22.10
    - export PATH="$HOME/.yarn/bin:$PATH"
    - cd $WORKING_DIR
  install:
    - yarn install --frozen-lockfile --silent
  script: yarn run test

jobs:
  include:
    - <<: *test
      env:
      - WORKING_DIR="$TRAVIS_BUILD_DIR/backend"
      - DATABSE_URL="mongodb+srv://OnbrandingDev:67Gp8lHWjN9Kq5hg@devcluster.n6mxb.mongodb.net/OnbrandingTestEnv?retryWrites=true&w=majority"
      - JWT_SECRET="OnlyTestKeyThisTime"



